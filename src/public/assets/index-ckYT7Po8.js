import{a as y,h as q,an as e,aC as S,ao as A}from"./index-ewVy9M9d.js";import{J as z,aH as b,aO as l,ax as I,S as f,aR as L,aS as N,C as M,aP as x,aQ as H,B as h,aW as Z,aK as V,ai as $,aZ as W,b9 as J,aU as F,aV as P}from"./IdurarOs-eHlzvnv3.js";import{_ as B,e as g,d as w,$ as K,f as Q,g as G,q as X,h as ee,r as te,i as ae,t as se,v as ne,p as le}from"./ErpApp-7Wu0aHhn.js";var oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464H332V240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v68c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-68c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zm-40 376H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"unlock",theme:"outlined"};const re=oe;var de=function(n,a){return y.createElement(z,q({},n,{ref:a,icon:re}))};const ie=y.forwardRef(de);function U({isUpdateForm:t=!1,isForAdminOwner:n=!1}){const a=b();return e.jsxs(e.Fragment,{children:[e.jsx(l.Item,{label:a("first Name"),name:"name",rules:[{required:!0}],children:e.jsx(I,{autoComplete:"off"})}),e.jsx(l.Item,{label:a("last Name"),name:"surname",rules:[{required:!0}],children:e.jsx(I,{autoComplete:"off"})}),e.jsx(l.Item,{label:a("email"),name:"email",rules:[{required:!0},{type:"email"}],children:e.jsx(I,{autoComplete:"off"})}),!t&&e.jsx(l.Item,{label:a("Password"),name:"password",rules:[{required:!0}],children:e.jsx(I.Password,{autoComplete:"new-password"})}),e.jsx(l.Item,{label:a("Role"),name:"role",rules:[{required:!0}],children:e.jsxs(f,{children:[e.jsx(f.Option,{value:"owner",disabled:!n,children:a("Account owner")}),e.jsx(f.Option,{value:"admin",disabled:n,children:a("super_admin")}),e.jsx(f.Option,{value:"manager",disabled:n,children:a("manager")}),e.jsx(f.Option,{value:"employee",disabled:n,children:a("employee")}),e.jsx(f.Option,{value:"create_only",disabled:n,children:a("create_only")}),e.jsx(f.Option,{value:"read_only",disabled:n,children:a("read_only")})]})}),e.jsx(l.Item,{label:a("enabled"),name:"enabled",valuePropName:"checked",initialValue:!0,children:e.jsx(L,{checkedChildren:e.jsx(N,{}),unCheckedChildren:e.jsx(M,{})})})]})}function ce({config:t,formElements:n,withUpload:a=!1}){let{entity:o}=t;const u=b(),i=S(),{current:r,isLoading:m,isSuccess:c}=A(B),{state:d,crudContextAction:p}=g(),{panel:j,collapsedBox:T,readBox:v}=p,k=()=>{v.open()},[E,D]=y.useState(!1),[C]=l.useForm(),O=s=>{const _=r._id;s.file&&a&&(s.file=s.file[0].originFileObj),i(x.update({entity:o,id:_,jsonData:s,withUpload:a}))};y.useEffect(()=>{if(r){let s={...r};s.birthday&&(s={...s,birthday:w(s.birthday).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),s.date&&(s={...s,date:w(s.date).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),s.expiredDate&&(s={...s,expiredDate:w(s.expiredDate).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),s.created&&(s={...s,created:w(s.created).format("YYYY-MM-DDTHH:mm:ss.SSSZ")}),s.updated&&(s={...s,updated:w(s.updated).format("YYYY-MM-DDTHH:mm:ss.SSSZ")});const _=r.role==="owner";D(_),C.resetFields(),C.setFieldsValue(s)}},[r]),y.useEffect(()=>{c&&(v.open(),T.open(),j.open(),C.resetFields(),i(x.resetAction({actionType:"update"})),i(x.list({entity:o})))},[c]);const{isEditBoxOpen:Y}=d,R=Y?{display:"block",opacity:1}:{display:"none",opacity:0};return e.jsx("div",{style:R,children:e.jsx(H,{isLoading:m,children:e.jsxs(l,{form:C,layout:"vertical",onFinish:O,children:[e.jsx(U,{isUpdateForm:!0,isForAdminOwner:E}),e.jsx(l.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(h,{type:"primary",htmlType:"submit",children:u("Save")})}),e.jsx(l.Item,{style:{display:"inline-block",paddingLeft:"5px"},children:e.jsx(h,{onClick:k,children:u("Cancel")})})]})})})}function ue({config:t}){const n=b();return e.jsx(K,{config:t,extra:[{label:n("Update Password"),key:"updatePassword",icon:e.jsx(ie,{})}]})}function me({config:t}){const n=b(),a=S(),{current:o}=A(B),{state:u,crudContextAction:i}=g(),[r]=l.useForm(),{onFetch:m,result:c,isLoading:d,isSuccess:p}=Z(),j=D=>{const C="admin/password-update/"+o._id,Y=(async()=>await V.patch({entity:C,jsonData:D}))();m(Y)},{readBox:T}=i,v=()=>{T.open()};y.useEffect(()=>{p&&(r.resetFields(),a(x.resetAction({actionType:"update"})))},[p]);const{isAdvancedBoxOpen:k}=u,E=k?{display:"block",opacity:1}:{display:"none",opacity:0};return e.jsx("div",{style:E,children:e.jsxs(H,{isLoading:d,children:[e.jsx("h3",{children:n("Update Password")}),e.jsx("div",{className:"space10"}),e.jsxs(l,{form:r,layout:"vertical",onFinish:j,children:[e.jsx(l.Item,{label:n("New Password"),name:"password",rules:[{required:!0}],children:e.jsx(I.Password,{autoComplete:"new-password"})}),e.jsx(l.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(h,{type:"primary",htmlType:"submit",children:n("Save")})}),e.jsx(l.Item,{style:{display:"inline-block",paddingLeft:"5px"},children:e.jsx(h,{onClick:v,children:n("Cancel")})})]})]})})}function pe({config:t,formElements:n}){const a=b(),{crudContextAction:o}=g(),{advancedBox:u,modal:i,editBox:r}=o,{result:m}=A(ee),c=S(),d=()=>{c(x.currentAction({actionType:"delete",data:m})),i.open()},p=()=>{c(x.currentAction({actionType:"update",data:m})),r.open()},j=()=>{c(x.currentAction({actionType:"update",data:m})),u.open()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space20"}),e.jsxs($,{children:[e.jsx(h,{onClick:d,type:"text",icon:e.jsx(te,{}),size:"small",children:a("remove")}),e.jsx(h,{onClick:p,type:"text",icon:e.jsx(W,{}),size:"small",children:a("edit")}),e.jsx(h,{onClick:j,type:"text",icon:e.jsx(J,{}),size:"small",children:a("Update Password")})]}),e.jsx("div",{className:"space20"}),e.jsx(ae,{config:t}),e.jsx(ce,{config:t,formElements:n,withUpload:!0}),e.jsx(me,{config:t})]})}function xe({config:t}){console.log(t);const{crudContextAction:n}=g(),{collapsedBox:a}=n,o=()=>{a.close()};return e.jsxs(e.Fragment,{children:[e.jsx(F,{gutter:12,children:e.jsx(P,{className:"gutter-row",span:24,children:e.jsx("h1",{style:{fontSize:20,marginBottom:20},children:t.PANEL_TITLE})})}),e.jsxs(F,{gutter:8,children:[e.jsx(P,{className:"gutter-row",span:21,children:e.jsx(se,{config:t})}),e.jsx(P,{className:"gutter-row",span:3,children:e.jsx(h,{onClick:o,block:!0,icon:e.jsx(ne,{})})})]})]})}function he({config:t,createForm:n,updateForm:a}){const o=S();return y.useLayoutEffect(()=>{o(x.resetState())},[]),e.jsxs(Q,{config:t,fixHeaderPanel:e.jsx(xe,{config:t}),sidePanelBottomContent:e.jsx(G,{config:t,formElements:n,withUpload:!0}),sidePanelTopContent:e.jsx(pe,{config:t,formElements:a}),children:[e.jsx(ue,{config:t}),e.jsx(X,{config:t})]})}const je={owner:"gold",admin:"magenta",manager:"purple",employee:"blue",create_only:"green",read_only:null};function be(){const t=b(),n="admin",a={displayLabels:["name","surname"],searchFields:"email,name,surname",outputValue:"_id"},o=["email"],u=[{title:t("first name"),dataIndex:"name"},{title:t("last name"),dataIndex:"surname"},{title:t("Email"),dataIndex:"email"},{title:t("role"),dataIndex:"role"}],i=[{title:t("first name"),dataIndex:"name"},{title:t("last name"),dataIndex:"surname"},{title:t("Email"),dataIndex:"email"},{title:t("role"),dataIndex:"role",render:(d,p)=>{const j=d==="owner"?"Account owner":d==="admin"?"super admin":d;return e.jsx(le,{color:je[d],children:t(j)})}},{title:t("enabled"),dataIndex:"enabled",onCell:()=>({props:{style:{width:"60px"}}}),render:(d,p)=>e.jsx(L,{checked:d,checkedChildren:e.jsx(N,{}),unCheckedChildren:e.jsx(M,{})})}],r={PANEL_TITLE:t("admin"),DATATABLE_TITLE:t("admin_list"),ADD_NEW_ENTITY:t("add_new_admin"),ENTITY_NAME:t("admin"),RECORD_ENTITY:t("record_payment")},c={...{entity:n,...r},readColumns:u,dataTableColumns:i,searchConfig:a,deleteModalLabels:o};return e.jsx(he,{createForm:e.jsx(U,{}),config:c})}export{be as default};
