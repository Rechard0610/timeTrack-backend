import{ao as _,an as t,aB as $,aC as C,a as b}from"./index-ewVy9M9d.js";import{L as O,r as M,N,K as P,n as F,B as z,o as w,O as H,T as K,v as W,Q as Y,M as q}from"./ErpApp-7Wu0aHhn.js";import{aH as Q,aY as U,aZ as Z,B as I,b6 as G}from"./IdurarOs-eHlzvnv3.js";import{e as i}from"./actions-cTR2S2ig.js";import{d as J,e as V}from"./selectors-c3wjZmkY.js";import{F as X}from"./FilePdfOutlined-MxuYIrr7.js";function ee({config:l}){const r=$(),{ADD_NEW_ENTITY:a,entity:s}=l,c=()=>{r(`/${s.toLowerCase()}/create`)};return t.jsx(I,{onClick:c,type:"primary",icon:t.jsx(W,{}),children:a})}function te({config:l,extra:r=[]}){const a=Q();let{entity:s,dataTableColumns:c,disableAdd:u=!1,searchConfig:n}=l;const{DATATABLE_TITLE:y}=l,{result:h,isLoading:f}=_(J),{pagination:g,items:j}=h,{erpContextAction:m}=O(),{modal:k}=m,D=[{label:a("Show"),key:"read",icon:t.jsx(U,{})},{label:a("Edit"),key:"edit",icon:t.jsx(Z,{})},{label:a("Download"),key:"download",icon:t.jsx(X,{})},...r,{type:"divider"},{label:a("Delete"),key:"delete",icon:t.jsx(M,{})}],x=$(),E=e=>{p(i.currentItem({data:e})),x(`/${s}/read/${e._id}`)},d=e=>{const o={...e};p(i.currentAction({actionType:"update",data:o})),x(`/${s}/update/${e._id}`)},A=e=>{window.open(`${G}${s}/${s}-${e._id}.pdf`,"_blank")},S=e=>{p(i.currentAction({actionType:"delete",data:e})),k.open()},v=e=>{p(i.currentItem({data:e})),x(`/invoice/pay/${e._id}`)};c=[...c,{title:"",key:"action",fixed:"right",render:(e,o)=>t.jsx(N,{menu:{items:D,onClick:({key:L})=>{switch(L){case"read":E(o);break;case"edit":d(o);break;case"download":A(o);break;case"delete":S(o);break;case"recordPayment":v(o);break}}},trigger:["click"],children:t.jsx(P,{style:{cursor:"pointer",fontSize:"24px"},onClick:L=>L.preventDefault()})})}];const p=C(),T=e=>{const o={page:e.current||1,items:e.pageSize||10};p(i.list({entity:s,options:o}))},R=()=>{p(i.list({entity:s}))};b.useEffect(()=>{const e=new AbortController;return R(),()=>{e.abort()}},[]);const B=e=>{const o={equal:e,filter:n==null?void 0:n.entity};p(i.list({entity:s,options:o}))};return t.jsxs(t.Fragment,{children:[t.jsx(F,{title:y,ghost:!0,extra:[t.jsx(z,{entity:n==null?void 0:n.entity,displayLabels:["name"],searchFields:"name",onChange:B},`${w.generate()}`),t.jsx(I,{onClick:T,icon:t.jsx(H,{}),children:a("Refresh")},`${w.generate()}`),!u&&t.jsx(ee,{config:l},`${w.generate()}`)],style:{padding:"20px 0px"}}),t.jsx(K,{columns:c,rowKey:e=>e._id,dataSource:j,pagination:g,loading:f,onChange:T,scroll:{x:!0}})]})}function se({config:l}){let{entity:r,deleteModalLabels:a,deleteMessage:s="Do you want delete : ",modalTitle:c="Remove Item"}=l;const u=C(),{current:n,isLoading:y,isSuccess:h}=_(V),{state:f,erpContextAction:g}=O(),{deleteModal:j}=f,{modal:m}=g,[k,D]=b.useState("");b.useEffect(()=>{if(h){m.close();const d={page:1,items:10};u(i.list({entity:r,options:d}))}if(n){let d=a.map(A=>Y(n,A)).join(" ");D(d)}},[h,n]);const x=()=>{const d=n._id;u(i.delete({entity:r,id:d})),m.close()},E=()=>{y||m.close()};return t.jsx(q,{title:c,open:j.isOpen,onOk:x,onCancel:E,confirmLoading:y,children:t.jsxs("p",{children:[s,k]})})}function re({config:l,extra:r}){const a=C(),{state:s}=O(),{deleteModal:c}=s,u=()=>{a(i.resetState())};return b.useLayoutEffect(()=>{const n=new AbortController;return u(),()=>{n.abort()}},[]),t.jsxs(t.Fragment,{children:[t.jsx(te,{config:l,extra:r}),t.jsx(se,{config:l,isOpen:c.isOpen})]})}export{re as E};
