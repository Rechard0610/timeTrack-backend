import{aC as k,aB as B,a as l,ao as D,an as t}from"./index-ewVy9M9d.js";import{z as E,V as P,n as A,p as H,o as j,v as I}from"./ErpApp-7Wu0aHhn.js";import{aH as b,aO as S,B as v,aX as N,aQ as z}from"./IdurarOs-eHlzvnv3.js";import{e as T}from"./actions-cTR2S2ig.js";import{f as Q}from"./selectors-c3wjZmkY.js";import{c as r}from"./calculate-2yTKWIus.js";import{C as R}from"./CloseCircleOutlined-QfALGiz_.js";function X({form:u}){const f=b(),o=()=>{u.submit()};return t.jsx(v,{onClick:o,type:"primary",icon:t.jsx(I,{}),children:f("Save")})}function Y({config:u,CreateForm:f}){const o=b(),n=k(),p=B();l.useEffect(()=>{n(E.list({entity:"setting"})),n(P.list())},[]);let{entity:i}=u;const{isLoading:L,isSuccess:h,result:F}=D(Q),[m]=S.useForm(),[$,y]=l.useState(0),[q,C]=l.useState(0),w=(a,c)=>{const s=c.items;let d=0,g=0;s&&(s.map(e=>{if(e){if(e.offerPrice&&e.quantity){let x=r.multiply(e.quantity,e.offerPrice);g=r.add(g,x)}if(e.quantity&&e.price){let x=r.multiply(e.quantity,e.price);d=r.add(d,x)}}}),y(d),C(g))};l.useEffect(()=>(h&&(m.resetFields(),n(T.resetAction({actionType:"create"})),y(0),C(0),p(`/${i.toLowerCase()}/read/${F._id}`)),()=>{}),[h]);const O=a=>{if(console.log("ðŸš€ ~ onSubmit ~ fieldsValue:",a),a&&a.items){let c=[...a.items];c.map(s=>{s.total=r.multiply(s.quantity,s.price)}),a={...a,items:c}}n(T.create({entity:i,jsonData:a}))};return t.jsxs(t.Fragment,{children:[t.jsx(A,{onBack:()=>{p(`/${i.toLowerCase()}`)},title:o("New"),ghost:!1,tags:t.jsx(H,{children:o("Draft")}),extra:[t.jsx(v,{onClick:()=>p(`/${i.toLowerCase()}`),icon:t.jsx(R,{}),children:o("Cancel")},`${j.generate()}`),t.jsx(X,{form:m},`${j.generate()}`)],style:{padding:"20px 0px"}}),t.jsx(N,{dashed:!0}),t.jsx(z,{isLoading:L,children:t.jsx(S,{form:m,layout:"vertical",onFinish:O,onValuesChange:w,children:t.jsx(f,{subTotal:$,offerTotal:q})})})]})}export{Y as C};
