import{aC as b,aB as I,a as l,ao as $,an as e,aK as F,aS as M}from"./index-ewVy9M9d.js";import{aH as R,B as c,b6 as W,b7 as Y,aZ as U,aU as g,aX as y,aV as a,b3 as q}from"./IdurarOs-eHlzvnv3.js";import{u as O,n as H,p as K,o as d}from"./ErpApp-7Wu0aHhn.js";import{E as C}from"./index-IjoPjNv1.js";import{e as _}from"./actions-cTR2S2ig.js";import{c as Q,s as V}from"./selectors-c3wjZmkY.js";import{u as X,S as p}from"./useMail-v3s_IPeq.js";import{t as Z}from"./statusTagColor-sG5xH6CK.js";import{D as j}from"./index-TnfYKfV7.js";import{C as z}from"./CloseCircleOutlined-QfALGiz_.js";import{F as G}from"./FilePdfOutlined-MxuYIrr7.js";import{R as J}from"./RetweetOutlined-aDj6H5tC.js";import"./Skeleton-a_sn-oBg.js";const ee=({item:r,currentErp:o})=>{const{moneyFormatter:s}=O();return e.jsxs(g,{gutter:[12,0],children:[e.jsxs(a,{className:"gutter-row",span:11,children:[e.jsx("p",{style:{marginBottom:5},children:e.jsx("strong",{children:r.itemName})}),e.jsx("p",{children:r.description})]}),e.jsx(a,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:s({amount:r.price,currency_code:o.currency})})}),e.jsx(a,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:r.quantity})}),e.jsx(a,{className:"gutter-row",span:5,children:e.jsx("p",{style:{textAlign:"right",fontWeight:"700"},children:s({amount:r.total,currency_code:o.currency})})}),e.jsx(y,{dashed:!0,style:{marginTop:0,marginBottom:15}})]},r._id)};function te({config:r,selectedItem:o}){var E;const s=R(),{entity:n,ENTITY_NAME:f}=r,u=b(),{moneyFormatter:i}=O(),{send:S,isLoading:v}=X({entity:n}),T=I(),[N,D]=l.useState({}),{result:x}=$(Q),P={status:"",lead:{name:"",email:"",phone:"",address:""},subTotal:0,taxTotal:0,taxRate:0,total:0,credit:0,number:0,year:0},[k,w]=l.useState([]),[t,A]=l.useState(o??P);return l.useEffect(()=>{const m=new AbortController;if(x){const{items:L,invoice:h,...B}=x;L?(w(L),A(x)):h.items&&(w(h.items),A({...h.items,...B,...h}))}return()=>m.abort()},[x]),l.useEffect(()=>{t!=null&&t.lead&&D(t.lead[t.lead.type])},[t]),e.jsxs(e.Fragment,{children:[e.jsx(H,{onBack:()=>{T(`/${n.toLowerCase()}`)},title:`${f} # ${t.number}/${t.year||""}`,ghost:!1,tags:e.jsx(K,{color:(E=Z(t.status))==null?void 0:E.color,children:s(t.status)}),extra:[e.jsx(c,{onClick:()=>{T(`/${n.toLowerCase()}`)},icon:e.jsx(z,{}),children:s("Close")},`${d.generate()}`),e.jsx(c,{onClick:()=>{window.open(`${W}${n}/${n}-${t._id}.pdf`,"_blank")},icon:e.jsx(G,{}),children:s("Download PDF")},`${d.generate()}`),e.jsx(c,{loading:v,onClick:()=>{S(t._id)},icon:e.jsx(Y,{}),children:s("Send by email")},`${d.generate()}`),e.jsx(c,{onClick:()=>{u(_.convert({entity:n,id:t._id}))},icon:e.jsx(J,{}),style:{display:n==="quote"?"inline-block":"none"},children:s("Convert to Invoice")},`${d.generate()}`),e.jsx(c,{onClick:()=>{u(_.currentAction({actionType:"update",data:t})),T(`/${n.toLowerCase()}/update/${t._id}`)},type:"primary",icon:e.jsx(U,{}),children:s("Edit")},`${d.generate()}`)],style:{padding:"20px 0px"},children:e.jsxs(g,{children:[e.jsx(p,{title:"Status",value:t.status}),e.jsx(p,{title:s("SubTotal"),value:i({amount:t.subTotal,currency_code:t.currency}),style:{margin:"0 32px"}}),e.jsx(p,{title:s("Total"),value:i({amount:t.total,currency_code:t.currency}),style:{margin:"0 32px"}}),e.jsx(p,{title:s("Paid"),value:i({amount:t.credit,currency_code:t.currency}),style:{margin:"0 32px"}})]})}),e.jsx(y,{dashed:!0}),e.jsxs(j,{title:`lead : ${t.lead.name}`,children:[e.jsx(j.Item,{label:s("Address"),children:N.address}),e.jsx(j.Item,{label:s("email"),children:N.email}),e.jsx(j.Item,{label:s("Phone"),children:N.phone})]}),e.jsx(y,{}),e.jsxs(g,{gutter:[12,0],children:[e.jsx(a,{className:"gutter-row",span:11,children:e.jsx("p",{children:e.jsx("strong",{children:s("product")})})}),e.jsx(a,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("PRICE")})})}),e.jsx(a,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("QUANTITY")})})}),e.jsx(a,{className:"gutter-row",span:5,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("TOTAL")})})}),e.jsx(y,{})]}),k.map(m=>e.jsx(ee,{item:m,currentErp:t},m._id)),e.jsx("div",{style:{width:"300px",float:"right",textAlign:"right",fontWeight:"700"},children:e.jsxs(g,{gutter:[12,-5],children:[e.jsx(a,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Sub Total")," : "]})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.subTotal,currency_code:t.currency})})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsxs("p",{children:["Tax Total (",t.taxRate," %) :"]})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.taxTotal,currency_code:t.currency})})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Total")," :"]})}),e.jsx(a,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.total,currency_code:t.currency})})})]})})]})}function se({config:r}){const o=b(),{id:s}=F();I(),l.useLayoutEffect(()=>{o(_.read({entity:r.entity,id:s}))},[s]);const{result:n,isSuccess:f,isLoading:u=!0}=$(V);return u?e.jsx(C,{children:e.jsx(M,{})}):e.jsx(C,{children:f?e.jsx(te,{config:r,selectedItem:n}):e.jsx(q,{entity:r.entity})})}function je(){const r=R(),o="offer",s={PANEL_TITLE:r("Offer Leads"),DATATABLE_TITLE:r("offer_list"),ADD_NEW_ENTITY:r("add_new_offer"),ENTITY_NAME:r("Offer Leads")},n={entity:o,...s};return e.jsx(se,{config:n})}export{je as default};
