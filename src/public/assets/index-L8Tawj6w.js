import{a,aB as K,an as l}from"./index-ewVy9M9d.js";import{aH as N,S as i,aK as E}from"./IdurarOs-eHlzvnv3.js";import{F as R,o as _,j as z}from"./ErpApp-7Wu0aHhn.js";const P=({entity:u,className:L="",searchFields:O="project",placeholder:b="Task",displayLabels:C=["name"],outputValue:o="_id",parentId:c="",showAll:f="",value:e,onChange:g})=>{var d;N();const[m,h]=a.useState([]),[k,r]=a.useState(void 0);K();const j=()=>{const s=/^[a-fA-F0-9]{24}$/.test(c);if(c[0]||s){const t={project:c,fields:O};return E.list({entity:u,options:t})}else return E.list({entity:u})},{result:p,isLoading:S,isSuccess:x}=R(j),A=async()=>{r(null);const{result:s}=await j();h(s)};a.useEffect(()=>{x&&h(p)},[x]),a.useEffect(()=>{c!==""&&A()},[c]);const T=s=>C.map(t=>s[t]).join(" ");a.useEffect(()=>{let s=e;e!==void 0&&e&&(console.log("-----------------------"),console.log(e),s=e[o]??e,r(s),g(s))},[e]);const $=s=>{const t=s[o]??s;r(s),g(t)},q=()=>{const s=[];if(m)return m.map(t=>{var v;const y=t[o]??t,B=T(t),D=((v=t[o])==null?void 0:v.color)??(t==null?void 0:t.color),n=z.find(H=>H.color===D);s.push({value:y,label:B,color:n==null?void 0:n.color})}),s};return l.jsxs(i,{loading:S,disabled:S,value:k,onChange:$,placeholder:b,defaultValue:f&&"",className:L,children:[f&&l.jsx(i.Option,{value:"",title:"All",children:"All"}),(d=q())==null?void 0:d.map(s=>l.jsx(i.Option,{value:s.value,children:s.label},`${_.generate()}`))]})};export{P as S};
